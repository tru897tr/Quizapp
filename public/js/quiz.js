const questions=[{id:1,question:"Python s·ª≠ d·ª•ng g√¨ ƒë·ªÉ x√°c ƒë·ªãnh kh·ªëi l·ªánh?",options:["Kho·∫£ng tr·∫Øng th·ª•t ƒë·∫ßu d√≤ng","D·∫•u ngo·∫∑c nh·ªçn {}","D·∫•u ch·∫•m ph·∫©y ;","D·∫•u g·∫°ch ngang ‚Äì"],correct:0},{id:2,question:"L·ªánh n√†o d√πng ƒë·ªÉ in d·ªØ li·ªáu ra m√†n h√¨nh?",options:["echo()","output()","print()","show()"],correct:2},{id:3,question:"ƒêo·∫°n m√£ if 5 > 3: c·∫ßn ƒëi·ªÅu g√¨ ƒë·ªÉ tr√°nh l·ªói?",options:["Th·ª•t ƒë·∫ßu d√≤ng ph√≠a sau","ƒê√≥ng ngo·∫∑c ; ·ªü cu·ªëi","ƒê·∫∑t d·∫•u {} bao quanh","Vi·∫øt th√™m d·∫•u nh√°y \"\""],correct:0},{id:4,question:"C√¢u l·ªánh n√†o t·∫°o v√≤ng l·∫∑p 5 l·∫ßn?",options:["for i in range(0, 6)","for i in range(5)","for i in 1..5","loop (5)"],correct:1},{id:5,question:"Trong Python, bi·∫øn d√πng ƒë·ªÉ l√†m g√¨?",options:["L∆∞u tr·ªØ d·ªØ li·ªáu t·∫°m th·ªùi","Ch·ª©a m√£ l·ªánh Python","L∆∞u h√¨nh ·∫£nh v√† file","T·∫°o th∆∞ m·ª•c m·ªõi"],correct:0},{id:6,question:"L·ªánh n√†o d√πng ƒë·ªÉ nh·∫≠p d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng?",options:["ask()","input()","receive()","get()"],correct:1},{id:7,question:"Trong l·ªánh print(\"Xin ch√†o\", 5+3), Python s·∫Ω:",options:["Gh√©p chu·ªói v√† s·ªë l·∫°i th√†nh m·ªôt chu·ªói duy nh·∫•t","In t·ª´ng ph·∫ßn theo th·ª© t·ª±","Kh√¥ng cho ph√©p in chu·ªói v√† s·ªë","B√°o l·ªói to√°n t·ª≠"],correct:1},{id:8,question:"Sai l·∫ßm ph·ªï bi·∫øn n√†o th∆∞·ªùng g·∫∑p?",options:["D√πng print thay b·∫±ng prnit","Sai d·∫•u nh√°y k√©p","Sai th·ª•t d√≤ng","T·∫•t c·∫£ c√°c √Ω tr√™n"],correct:3},{id:9,question:"L·ªánh n√†o m·ªü file ·ªü ch·∫ø ƒë·ªô ghi n·ªëi ti·∫øp kh√¥ng x√≥a n·ªôi dung?",options:["open(\"x.txt\", \"a\")","open(\"x.txt\", \"w\")","open(\"x.txt\", \"r\")","open(\"x.txt\", \"x\")"],correct:0},{id:10,question:"Trong hi·ªáu ·ª©ng ch·ªØ ch·∫°y, time.sleep(0.1) c√≥ t√°c d·ª•ng g√¨?",options:["L√†m ch∆∞∆°ng tr√¨nh d·ª´ng l·∫°i ch√∫t","X√≥a m√†n h√¨nh tr∆∞·ªõc ƒë√≥","T·∫°o th√™m m·ªôt d√≤ng m·ªõi","TƒÉng t·ªëc in k√Ω t·ª±"],correct:0},{id:11,question:"flush=True trong print() nghƒ©a l√† g√¨?",options:["Gi·ªØ l·∫°i k√Ω t·ª±","Bu·ªôc in ngay l·∫≠p t·ª©c","X√≥a b·ªô nh·ªõ ƒë·ªám","Kh√¥ng in g√¨ c·∫£"],correct:1},{id:12,question:"Khi ch·∫°y Python b·∫±ng VS Code, ƒëu√¥i file ph·∫£i l√† g√¨?",options:[".exe",".py",".txt",".cmd"],correct:1},{id:13,question:"L·ªánh ki·ªÉm tra phi√™n b·∫£n Python tr√™n m√°y?",options:["python version","py --check","python --version","py.ver()"],correct:2},{id:14,question:"Trong Termux, l·ªánh c√†i Python l√†:",options:["pkg get python","pkg install python","install python now","setup python"],correct:1},{id:15,question:"enumerate(list, 1) d√πng ƒë·ªÉ l√†m g√¨?",options:["T·∫°o s·ªë th·ª© t·ª± b·∫Øt ƒë·∫ßu t·ª´ 1","ƒê·∫£o ng∆∞·ª£c danh s√°ch","X√≥a ph·∫ßn t·ª≠ ƒë·∫ßu","Chuy·ªÉn t√™n th√†nh s·ªë"],correct:0},{id:16,question:"C√¢u l·ªánh n√†o g√°n gi√° tr·ªã cho bi·∫øn ƒë√∫ng chu·∫©n?",options:["name == \"Tru\"","name := \"Tru\"","name = \"Tru\"","set(name, \"Tru\")"],correct:2},{id:17,question:"Python Shell ƒë∆∞·ª£c m·ªü b·∫±ng c√°ch n√†o?",options:["G√µ python trong terminal","Click file python.exe","Nh·∫≠p shell.py","Ch·∫°y runpython"],correct:0},{id:18,question:"Khi th·ª•t ƒë·∫ßu d√≤ng sai, Python b√°o l·ªói g√¨?",options:["SyntaxWrong","IndentationError","SpaceFault","TabMismatch"],correct:1},{id:19,question:"L·ªánh while n√†o ƒë√∫ng c√∫ ph√°p?",options:["while x < 5","while (x < 5) do","while x < 5:","do while (x<5)"],correct:2},{id:20,question:"ƒê·ªÉ ghi v√†o file v√† ƒë√≥ng sau khi ghi xong, ta d√πng:",options:["f.open(); f.print();","open(); write(); stop();","f = open(...); f.write(...); f.close()","createfile(); end();"],correct:2},{id:21,question:"C√¢u l·ªánh n√†o KH√îNG ph·∫£i l√† l·ªánh xu·∫•t d·ªØ li·ªáu trong Python?",options:["print()","format()","f-string","output()"],correct:3},{id:22,question:"Khi vi·∫øt name = input(\"T√™n: \"), ki·ªÉu d·ªØ li·ªáu nh·∫≠n ƒë∆∞·ª£c l√† g√¨?",options:["S·ªë nguy√™n","Chu·ªói","T·ª± ƒë·ªông nh·∫≠n d·∫°ng","Ki·ªÉu boolean"],correct:1},{id:23,question:"L·ªánh n√†o v·ª´a m·ªü file v·ª´a ghi ƒë√® to√†n b·ªô n·ªôi dung c≈©?",options:["open(\"file.txt\", \"w\")","open(\"file.txt\", \"a\")","open(\"file.txt\", \"r\")","open(\"file.txt\", \"wa\")"],correct:0},{id:24,question:"Python b√°o l·ªói khi n√†o?",options:["Vi·∫øt print sai ch√≠nh t·∫£","Sai th·ª•t d√≤ng","Thi·∫øu d·∫•u nh√°y","T·∫•t c·∫£ c√°c l√Ω do tr√™n"],correct:3},{id:25,question:"Trong c·∫•u tr√∫c if‚Äìelse, ph·∫ßn else ƒë∆∞·ª£c th·ª±c thi khi:",options:["ƒêi·ªÅu ki·ªán ƒë√∫ng","ƒêi·ªÅu ki·ªán sai","ƒêi·ªÅu ki·ªán kh√¥ng t·ªìn t·∫°i","C·∫£ 2 t√¨nh hu·ªëng ƒë√∫ng & sai"],correct:1},{id:26,question:"range(3) t·∫°o ra nh·ªØng gi√° tr·ªã n√†o?",options:["1, 2, 3","0, 1, 2","0, 1, 2, 3","1, 2"],correct:1},{id:27,question:"D√≤ng l·ªánh n√†o KH√îNG g√¢y l·ªói?",options:["age = int(\"17\")","age = int(\"m∆∞·ªùi b·∫£y\")","age = int(\"17a\")","age = int(\"\")"],correct:0},{id:28,question:"Khi d√πng f-string, c√∫ ph√°p ƒë√∫ng l√†:",options:["f(\"T√™n: {a}\")","f\"Hello {name}\"","f{'Tu·ªïi: {age}'}","f<\"D·ªØ li·ªáu: {x}\">"],correct:1},{id:29,question:"L·ªánh n√†o d√πng ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng in t·ª´ng ch·ªØ?",options:["print(char, flush=0)","print(char, end=\"\", flush=True)","print(end=\"\", char, True)","print(flush=\"\")"],correct:1},{id:30,question:"Mu·ªën Python th·ª±c thi file tesst.py, ta d√πng:",options:["py run tesst","python tesst.py","start tesst","run.py tesst"],correct:1},{id:31,question:"C√¢u l·ªánh n√†o v·ª´a t·∫°o file m·ªõi v·ª´a b√°o l·ªói n·∫øu file ƒë√£ t·ªìn t·∫°i?",options:["open(\"a.txt\", \"w\")","open(\"a.txt\", \"x\")","open(\"a.txt\", \"a\")","open(\"a.txt\", \"t\")"],correct:1},{id:32,question:"Khi m·ªü Python Shell, d·∫•u nh·∫Øc l·ªánh xu·∫•t hi·ªán d∆∞·ªõi d·∫°ng:",options:[">>>",":::","...","###"],correct:0},{id:33,question:"Trong v√≤ng l·∫∑p while, n·∫øu qu√™n tƒÉng gi√° tr·ªã bi·∫øn, ƒëi·ªÅu g√¨ x·∫£y ra?",options:["V√≤ng l·∫∑p ch·∫°y ƒë√∫ng 1 l·∫ßn","B√°o l·ªói logic","V√≤ng l·∫∑p v√¥ h·∫°n","M√°y t·ª± s·ª≠a v√† ti·∫øp t·ª•c"],correct:2},{id:34,question:"L·ªánh n√†o d√πng ƒë·ªÉ chuy·ªÉn chu·ªói sang s·ªë nguy√™n?",options:["convert(str)","int()","number()","parse()"],correct:1},{id:35,question:"M·ªôt bi·∫øn h·ª£p l·ªá trong Python KH√îNG ƒë∆∞·ª£c b·∫Øt ƒë·∫ßu b·∫±ng:",options:["Ch·ªØ c√°i","D·∫•u g·∫°ch d∆∞·ªõi _","Ch·ªØ s·ªë","K√Ω t·ª± th∆∞·ªùng"],correct:2}];let currentQuestion=0,startTime=Date.now(),timerInterval,questionStartTime=Date.now(),timePerQuestion=[],userAnswers={},shuffledQuestions=[];function initializeQuestions(){shuffledQuestions=questions.map(q=>{const indices=[0,1,2,3];for(let i=indices.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[indices[i],indices[j]]=[indices[j],indices[i]]}const shuffledOptions=indices.map(i=>q.options[i]),newCorrectIndex=indices.indexOf(q.correct);return{...q,options:shuffledOptions,correct:newCorrectIndex}})}function startTimer(){timerInterval=setInterval(()=>{const elapsed=Math.floor((Date.now()-startTime)/1000),minutes=Math.floor(elapsed/60),seconds=elapsed%60;document.getElementById('timer').textContent=String(minutes).padStart(2,'0')+':'+String(seconds).padStart(2,'0')},1000)}function displayQuestion(){const q=shuffledQuestions[currentQuestion],userAnswer=userAnswers[currentQuestion];document.getElementById('currentQ').textContent=currentQuestion+1;document.getElementById('totalQ').textContent=questions.length;document.getElementById('progress').style.width=((currentQuestion)/questions.length)*100+'%';let optionsHTML='';for(let idx=0;idx<q.options.length;idx++){let classes='option',clickable=true;if(userAnswer!==undefined){if(idx===q.correct)classes+=' correct';if(userAnswer.wrongAttempts&&userAnswer.wrongAttempts.includes(idx))classes+=' wrong';if(userAnswer.correctAnswer!==undefined){classes+=' disabled';clickable=false}}const onclickAttr=clickable?'onclick="checkAnswer('+idx+')"':'';optionsHTML+='<div class="'+classes+'" '+onclickAttr+'><div class="option-label">'+String.fromCharCode(65+idx)+'</div><div>'+q.options[idx]+'</div></div>'}const isAnswered=userAnswer&&userAnswer.correctAnswer!==undefined,prevDisabled=currentQuestion===0?'disabled':'',nextDisabled=!isAnswered?'disabled':'';document.getElementById('quizArea').innerHTML='<div class="question-card"><div class="question-text">'+q.question+'</div><div class="options-grid">'+optionsHTML+'</div><div class="quiz-navigation"><button class="nav-button prev" onclick="prevQuestion()" '+prevDisabled+'>‚Üê Quay l·∫°i</button><button class="nav-button next" onclick="nextQuestion()" '+nextDisabled+'>Ti·∫øp t·ª•c ‚Üí</button></div></div>'}function checkAnswer(selected){const q=shuffledQuestions[currentQuestion],userAnswer=userAnswers[currentQuestion]||{wrongAttempts:[]};if(userAnswer.correctAnswer!==undefined)return;if(userAnswer.wrongAttempts.includes(selected))return;const options=document.querySelectorAll('.option');if(selected===q.correct){options[selected].classList.add('correct');const questionTime=Math.floor((Date.now()-questionStartTime)/1000);timePerQuestion[currentQuestion]=questionTime;userAnswers[currentQuestion]={...userAnswer,correctAnswer:selected};options.forEach(opt=>opt.classList.add('disabled'));document.querySelector('.nav-button.next').disabled=false}else{options[selected].classList.add('wrong');userAnswer.wrongAttempts.push(selected);userAnswers[currentQuestion]=userAnswer;options[selected].style.pointerEvents='none'}}function prevQuestion(){if(currentQuestion>0){currentQuestion--;displayQuestion()}}function nextQuestion(){if(currentQuestion<questions.length-1){currentQuestion++;questionStartTime=Date.now();displayQuestion()}else{showResults()}}async function showResults(){clearInterval(timerInterval);const totalTime=Math.floor((Date.now()-startTime)/1000),minutes=Math.floor(totalTime/60),seconds=totalTime%60,validTimes=timePerQuestion.filter(t=>t!==undefined),avgTime=validTimes.length>0?Math.floor(validTimes.reduce((a,b)=>a+b,0)/validTimes.length):0,fastestTime=validTimes.length>0?Math.min(...validTimes):0,slowestTime=validTimes.length>0?Math.max(...validTimes):0;try{await fetch('/api/save-result',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({totalTime,avgTime,fastestTime,slowestTime})})}catch(error){}document.getElementById('quizStats').style.display='none';document.querySelector('.progress-bar').style.display='none';document.getElementById('quizArea').innerHTML='<div class="result-screen"><div class="result-icon">üèÜ</div><h1 class="result-title">Ch√∫c m·ª´ng!</h1><p>B·∫°n ƒë√£ ho√†n th√†nh b√†i tr·∫Øc nghi·ªám</p><div class="result-time">'+minutes+':'+String(seconds).padStart(2,'0')+'</div><div class="result-stats"><div class="result-stat"><div class="result-stat-label">Th·ªùi gian trung b√¨nh</div><div class="result-stat-value">'+avgTime+'s</div></div><div class="result-stat"><div class="result-stat-label">C√¢u nhanh nh·∫•t</div><div class="result-stat-value">'+fastestTime+'s</div></div><div class="result-stat"><div class="result-stat-label">C√¢u ch·∫≠m nh·∫•t</div><div class="result-stat-value">'+slowestTime+'s</div></div><div class="result-stat"><div class="result-stat-label">T·ªïng c√¢u h·ªèi</div><div class="result-stat-value">'+questions.length+'</div></div></div><div class="result-buttons"><button class="btn btn-primary" onclick="location.reload()">L√†m l·∫°i</button><button class="btn btn-secondary" onclick="window.location.href=\'/\'">V·ªÅ trang ch·ªß</button></div></div>'}function toggleFullscreen(){if(!document.fullscreenElement){document.documentElement.requestFullscreen();document.body.classList.add('fullscreen-mode')}else{document.exitFullscreen();document.body.classList.remove('fullscreen-mode')}}function exitFullscreen(){if(document.fullscreenElement){document.exitFullscreen()}}document.addEventListener('fullscreenchange',()=>{if(!document.fullscreenElement){document.body.classList.remove('fullscreen-mode')}});document.addEventListener('keydown',(e)=>{if(e.key==='Escape'&&document.fullscreenElement){exitFullscreen()}});function quit(){if(confirm('B·∫°n c√≥ ch·∫Øc mu·ªën tho√°t? Ti·∫øn ƒë·ªô s·∫Ω kh√¥ng ƒë∆∞·ª£c l∆∞u.')){window.location.href='/'}}window.addEventListener('DOMContentLoaded',async()=>{try{const response=await fetch('/api/verify');if(!response.ok){window.location.href='/login';return}const result=await response.json();document.getElementById('username').textContent=result.user.username;initializeQuestions();displayQuestion();startTimer()}catch(error){window.location.href='/login'}});
